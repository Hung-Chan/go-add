kind: pipeline
type: docker
name: default

steps:
- name: test
  image: golang
  volumes:
  - name: deps
    path: /go
  commands:
  - go test
  when:
    branch:
      - dev

- name: build
  image: golang
  volumes:
  - name: deps
    path: /go
  commands:
  - go build

- name: deploy
  image: appleboy/drone-ssh
  # volumes:
  #   - '~/.ssh/id_rsa:/.ssh/id_rsa'
  settings:
    host: 10.159.5.115
    username: root
    # password: password
    port: 9654
    key:
      from_secret: drone_key
    script:
      - echo hello
      - echo world
      - cd /home/

volumes:
- name: deps
  temp: {}


